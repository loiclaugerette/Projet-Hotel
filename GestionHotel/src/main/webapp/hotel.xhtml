<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
	<title>Hôtels</title>
</h:head>

<body>

	<h:outputStylesheet name="css/bootstrap.css" />
	<h:outputScript name="resources/js/bootstrap.js" />

	<ui:include src="navbar.xhtml" />

	<div class="container" style="margin-top:40px">
		<h1 class="page-header">Création d'hôtels</h1>

		

		<!--  =============================== Liste des Hôtels (Data Exporter)  =============================== -->
		<h2>Liste des hôtels</h2>

		<h:form id="form">
			<p:growl id="msgs" showDetail="true" />
			<p:dataTable id="multipleDT" var="h" value="#{hotelBean.hotels}"
				selectionMode="multiple" selection="#{hotelBean.selectedHotels}"
				rowKey="#{h.id}">
				<f:facet name="header">
            Liste des hôtels
        </f:facet>
				<p:column headerText="Id">
					<h:outputText value="#{h.id}" />
				</p:column>
				<p:column headerText="Nom">
					<h:outputText value="#{h.nom}" />
				</p:column>
				<p:column headerText="Ville">
					<h:outputText value="#{h.adresse.ville}" />
				</p:column>
				<p:column headerText="Etoiles">
					<h:outputText value="#{h.nombreEtoiles}" />
				</p:column>
				<p:column headerText="Pays">
					<h:outputText value="#{h.adresse.pays}" />
				</p:column>
				<f:facet name="footer">
					<p:commandButton process="multipleDT" update=":form:multiCarDetail"
						icon="ui-icon-search" value="Modifier"
						oncomplete="PF('multiCarDialog').show()" />
					<p:commandButton value="Afficher les chambres"
						update="listChambreByHotel"
						actionListener="#{hotelBean.getChambreByHotel}"
						icon="ui-icon-check" />
					<p:commandButton process="multipleDT"
						update=":form:multiFactDetail" icon="ui-icon-search"
						value="Afficher Factures et bénéfice"
						oncomplete="PF('multiFactDialog').show()"
						actionListener="#{hotelBean.benef}" />
				</f:facet>
			</p:dataTable>

			<!-- ==================================== Modifier chambre =================================== -->
			<p:dialog header="Modification" widgetVar="multiCarDialog"
				modal="true" showEffect="fade" hideEffect="fade" resizable="false"
				width="400">
				<p:outputPanel id="multiCarDetail" style="text-align:center;">
					<ui:repeat value="#{hotelBean.selectedHotels}" var="h">
						<p:panelGrid columns="2">
							<h:outputText value="Nom : "></h:outputText>
							<h:inputText requiredMessage="obligatoire" required="true"
								value="#{h.nom}"></h:inputText>
							<h:outputText value="Rue : "></h:outputText>
							<h:inputText requiredMessage="obligatoire" required="true"
								value="#{h.adresse.rue}"></h:inputText>
							<h:outputText value="Ville : "></h:outputText>
							<h:inputText requiredMessage="obligatoire" required="true"
								value="#{h.adresse.ville}"></h:inputText>
							<h:outputText value="Code Postal : "></h:outputText>
							<h:inputText requiredMessage="obligatoire" required="true"
								value="#{h.adresse.codePostal}"></h:inputText>
							<h:outputText value="Pays : "></h:outputText>
							<h:inputText requiredMessage="obligatoire" required="true"
								value="#{h.adresse.pays}"></h:inputText>
							<h:outputText value="Etoiles : "></h:outputText>
							<h:inputText requiredMessage="obligatoire" required="true"
								value="#{h.nombreEtoiles}"></h:inputText>

							<h:commandButton value="Valider" action="#{hotelBean.update}"
								class="btn btn-info" />
						</p:panelGrid>
					</ui:repeat>
				</p:outputPanel>
			</p:dialog>

			<!-- ==================================== Afficher facture =================================== -->
			<p:dialog header="Facture" widgetVar="multiFactDialog" modal="true"
				showEffect="fade" hideEffect="fade" resizable="false" width="400">
				<p:outputPanel id="multiFactDetail" style="text-align:center;">
					<ui:repeat value="#{hotelBean.facturesByHotel}" var="f">
						<p:panelGrid columns="2">
							<h:outputText value="Id : "></h:outputText>
							<h:outputText id="factId" value="#{f.id}"></h:outputText>
							<h:outputText value="Coût réservation : "></h:outputText>
							<h:outputText id="factCouReserv" value="#{f.coutReservation}"></h:outputText>
							<h:outputText value="Coût consommation : "></h:outputText>
							<h:outputText id="factCoutConso" value="#{f.coutConsommation}"></h:outputText>
						</p:panelGrid>
						<br></br>
					</ui:repeat>
					<p:panelGrid columns="2">
						<h:outputText value="Bénéfice : "></h:outputText>
						<h:outputText id="benefOutput" value="#{hotelBean.benefice}"></h:outputText>
					</p:panelGrid>
				</p:outputPanel>
			</p:dialog>

		</h:form>
		<!-- Liste des hôtels -->

		<div style="margin-top: 20px;"></div>


		<h:form id="listChambreByHotel">
		   
			<p:dataTable id="tbl" var="chbh" value="#{hotelBean.chambresByHotel}"
				paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
				paginator="true" rows="10" style="margin-bottom:20px"
				selectionMode="multiple" selection="#{hotelBean.selectedChambres}" rendered="#{not empty hotelBean.chambresByHotel}"
				rowKey="#{chbh.id}">

				<p:column>
					<f:facet name="header">
						<h:outputText value="Id" />
					</f:facet>
					<h:outputText value="#{chbh.id}" />
				</p:column>

				<p:column>
					<f:facet name="header">
						<h:outputText value="Description" />
					</f:facet>
					<h:outputText value="#{chbh.description}" />
				</p:column>

				<p:column>
					<f:facet name="header">
						<h:outputText value="Numéro" />
					</f:facet>
					<h:outputText value="#{chbh.numeroChambre}" />
				</p:column>

				<p:column>
					<f:facet name="header">
						<h:outputText value="Prix" />
					</f:facet>
					<h:outputText value="#{chbh.prix}" />
				</p:column>

				<p:column>
					<f:facet name="header">
						<h:outputText value="Type" />
					</f:facet>
					<h:outputText value="#{chbh.getClass().getSimpleName()}" />
				</p:column>

				<f:facet name="footer">
					<p:commandButton process="tbl"
						update=":listChambreByHotel:multiChambreDetail"
						icon="ui-icon-search" value="Modifier"
						oncomplete="PF('multiChambreDialog').show()" />
					<p:commandButton process="tbl"
						update=":listChambreByHotel:multiChambreDetail"
						icon="ui-icon-search" value="Ajouter une chambre"
						oncomplete="PF('ajoutChambreDialog').show()" />

				</f:facet>
			
			</p:dataTable>


			<!-- Dialog Modifier chambre -->
			<p:dialog header="Modification Chambres"
				widgetVar="multiChambreDialog" modal="true" showEffect="fade"
				hideEffect="fade" resizable="false" width="400">
				<p:outputPanel id="multiChambreDetail" style="text-align:center;">
					<ui:repeat value="#{hotelBean.selectedChambres}" var="ch">
						<p:panelGrid columns="2">
							<h:outputText value="Description: "></h:outputText>
							<h:inputText requiredMessage="obligatoire" required="true"
								value="#{ch.description}"></h:inputText>
							<h:outputText value="Numéro : "></h:outputText>
							<h:inputText requiredMessage="obligatoire" required="true"
								value="#{ch.numeroChambre}"></h:inputText>

							<h:commandButton value="Valider"
								action="#{hotelBean.updateChambres}" class="btn btn-info" />

						</p:panelGrid>
					</ui:repeat>
				</p:outputPanel>
			</p:dialog>

			<!-- Dialog Ajouter chambre -->
			<p:dialog header="Ajouter une Chambre" widgetVar="ajoutChambreDialog"
				modal="true" showEffect="fade" hideEffect="fade" resizable="false"
				width="400">
				<p:outputPanel id="ajoutChambreDetail" style="text-align:center;">
					<p:panelGrid columns="2">

						<h:outputText value="Description: "></h:outputText>
						<h:inputText value="#{hotelBean.description}"></h:inputText>
						<h:outputText value="Numéro : "></h:outputText>
						<h:inputText value="#{hotelBean.numeroChambre}"></h:inputText>
						<h:outputText value="Type :  "></h:outputText>
						<p:selectOneMenu id="type" value="#{hotelBean.type}"
							style="width:125px ; margin-right : 10px; margin-left : 15px;">
							<f:selectItem itemLabel="Chambre simple"
								itemValue="ChambreSimple" />
							<f:selectItem itemLabel="Chambre double"
								itemValue="ChambreDouble" />
							<f:selectItem itemLabel="Suite" itemValue="Suite" />
						</p:selectOneMenu>

						<h:commandButton value="Valider"
							action="#{hotelBean.addChambreToHotel}" class="btn btn-info" />

					</p:panelGrid>

				</p:outputPanel>
			</p:dialog>

		</h:form>

		<div style="margin-top: 70px;"></div>


		<!-- ================================== Ajouter un hôtel ====================================-->
		<h2>Ajouter un hôtel</h2>
		<div style="margin-bottom: 50px">
			<p:panel id="panel">

				<h4>Ajouter Chambres</h4>
				<h:form id="chambre">
					<p:messages id="msgs" />
					<table>
					   <tr>
					     <td><p:outputLabel for="numero" value="Numero:" />
						<p:inputText id="numero" value="#{hotelBean.numeroChambre}"
							required="true" label="Numero"
							style="margin-right : 10px; margin-left : 15px;" size="4">
							<f:validateLength minimum="1" />
						</p:inputText>
						<p:message for="numero" display="icon" /></td>
						<td><p:outputLabel for="description" value="Description:" />
						<p:inputText id="description" value="#{hotelBean.description}"
							label="Description" required="true"
							style="margin-right : 10px; margin-left : 15px;">
							<f:validateLength minimum="2" />
							<p:ajax update="msgDescription" event="keyup" />
						</p:inputText>
						<p:message for="description" id="msgDescription" display="icon" /></td>
						<td><p:selectOneMenu id="type" value="#{hotelBean.type}"
							style="width:170px!important;overflow:inherit!important;margin-left:10px!important;padding:0px!important;margin-right:20px">
							<f:selectItem itemLabel="Chambre simple"
								itemValue="ChambreSimple" />
							<f:selectItem itemLabel="Chambre double"
								itemValue="ChambreDouble" />
							<f:selectItem itemLabel="Suite" itemValue="Suite" />
						</p:selectOneMenu></td>
						<td><p:commandButton value="Ajouter chambre" update="listChambre"
							actionListener="#{hotelBean.addChambre}" icon="ui-icon-check" /></td>
					   </tr>
					</table>
				
				</h:form>
				<!-- Ajouter Chambres -->

				<br></br>
				<p:separator />
				<br></br>

				<h4>Liste de chambres</h4>

				<h:form id="listChambre">
					<p:dataTable id="tbl" var="ch" value="#{hotelBean.chambresTBA}"
						paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
						paginator="true" rows="10" style="margin-bottom:20px" rendered="#{not empty hotelBean.chambresTBA}">

						<p:column>
							<f:facet name="header">
								<h:outputText value="Id" />
							</f:facet>
							<h:outputText value="#{ch.id}" />
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="Description" />
							</f:facet>
							<h:outputText value="#{ch.description}" />
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="Numéro" />
							</f:facet>
							<h:outputText value="#{ch.numeroChambre}" />
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="Prix" />
							</f:facet>
							<h:outputText value="#{ch.prix}" />
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="Type" />
							</f:facet>
							<h:outputText value="#{ch.getClass().getSimpleName()}" />
						</p:column>

					</p:dataTable>

					<h:form>
						<!-- Liste de chambresTBA (To Be Added) -->
						<p:growl id="message" showDetail="true" />

						<p:commandButton value="Supprimer toutes les chambres"
							actionListener="#{hotelBean.emptyChambres}" update="listChambre">
							<p:confirm header="Confirmation" message="Êtes-vous sûr ?"
								icon="ui-icon-alert" />
						</p:commandButton>

						<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
							<p:commandButton value="Oui" type="button"
								styleClass="ui-confirmdialog-yes" icon="ui-icon-check"
								actionListener="#{hotelBean.emptyChambres}" />
							<p:commandButton value="Non" type="button"
								styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
						</p:confirmDialog>
					</h:form>

				</h:form>
				<!-- Chambres data exporter -->



				<!--  =============================== Informations de l'hôtel  =============================== -->

				<br></br>
				<p:separator />
				<br></br>
               
				<h4>Informations de l'hôtel</h4>
		
                 <br></br>
				<h:form id="form2">
					<!-- Ajout hôtel -->
					<p:messages id="msgs" />


					<p:outputLabel for="nom" value="Nom:" style="padding-right:71px!important" />
					<p:inputText onkeyup="get(id)" id="nom" value="#{hotelBean.nom}" required="true"
						label="nom" style="margin-right : 60px;">
						<f:validateLength minimum="2" />
					</p:inputText>
					<span id="error"></span>
					<span>
					<h:graphicImage id="img" style="display:none;" name="img/tick-sign.png"/>
					</span>
					<p:message for="nom" display="icon" />
                    <br></br>
					<table>
						<tr>
							<td><p:outputLabel for="rue" value="Adresse:" style="padding-right:44px!important" /></td>
							<td><p:inputText id="rue" value="#{hotelBean.rue}"
									label="rue" required="true" size="3"
									style="margin-right : 10px;">
								</p:inputText> <p:watermark for="rue" value="rue" /> <p:message for="rue"
									id="msgRue" display="icon" /></td>
							<td><p:inputText id="codePostal"
									value="#{hotelBean.codePostal}" label="codePostal"
									required="true" size="5" style="margin-right : 10px;">
									<f:validateLength minimum="2" />
									<p:ajax update="msgCodePostal" event="keyup" />
								</p:inputText> <p:watermark for="codePostal" value="Code Postal" /> <p:message
									for="codePostal" id="msgCodePostal" display="icon" /></td>
							<td><p:inputText id="ville" value="#{hotelBean.ville}"
									label="ville" required="true" size="10"
									style="margin-right : 10px;">
									<f:validateLength minimum="2" />
									<p:ajax update="msgVille" event="keyup" />
								</p:inputText> <p:watermark for="ville" value="Ville" /> <p:message
									for="ville" id="msgVille" display="icon" /></td>
							<td><p:inputText id="pays" value="#{hotelBean.pays}"
									label="pays" required="true" size="10"
									style="margin-right : 10px;">
									<f:validateLength minimum="2" />
									<p:ajax update="msgPays" event="keyup" />
								</p:inputText> <p:watermark for="pays" value="Pays" /> <p:message for="pays"
									id="msgPays" display="icon" /></td>
						</tr>
						
					</table>
					
                    <br></br>
					<h:panelGrid columns="3" cellpadding="5">
						<h:outputText value="Nombre d'étoiles : " />
						<p:rating value="#{hotelBean.nombreEtoiles}" />
					</h:panelGrid>
					 <br></br>
					<p:commandButton value="Save" update="form" style="margin-bottom:20px;"
							actionListener="#{hotelBean.addHotel}" icon="ui-icon-check" />
				</h:form>
				<!-- Ajout hôtel -->


			</p:panel>
			<!-- Panel ajouter hôtels (assez FAT) -->
		</div>


	</div>
	<script type="text/javascript">
          function get(id){
        	  var img = document.getElementById("form2:img");
        	  var error = document.getElementById("error");
        	  var x = document.getElementById(id);

             if(x.value.length >3){
            	 img.style.display ='inline-block';
            	 error.innerHTML = "";
             }
             else if(x.value.length == 0){
            	 error.innerHTML = "";
             }
             
             
             else{
            	 img.style.display ='none';
            	 error.innerHTML = "Veuillez ..................."
             }
          }
    </script>
	<!-- container (bootstrap) -->

	<!-- jQuery -->
	<script src="js/jquery.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="js/bootstrap.min.js"></script>

</body>
</html>





